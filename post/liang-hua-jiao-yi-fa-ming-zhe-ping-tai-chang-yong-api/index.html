<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>量化交易——发明者平台常用API | LightHunter</title>

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://lienguang0624.github.io//favicon.ico?v=1619085541060">
<link rel="stylesheet" href="https://lienguang0624.github.io//styles/main.css">



<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>



    <meta name="description" content="基本策略框架
def onTick():
    Log(exchange.GetTicker())

def main():
    while True:
        onTick()
        Sleep(60000)

o..." />
    <meta name="keywords" content="" />
  </head>
  <body>
    <div id="app" class="main">

      <div class="sidebar" :class="{ 'full-height': menuVisible }">
  <div class="top-container" data-aos="fade-right">
    <div class="top-header-container">
      <a class="site-title-container" href="https://lienguang0624.github.io/">
        <img src="https://lienguang0624.github.io//images/avatar.png?v=1619085541060" class="site-logo">
        <h1 class="site-title">LightHunter</h1>
      </a>
      <div class="menu-btn" @click="menuVisible = !menuVisible">
        <div class="line"></div>
      </div>
    </div>
    <div>
      
        
          <a href="/" class="site-nav">
            首页
          </a>
        
      
        
          <a href="/archives" class="site-nav">
            归档
          </a>
        
      
        
          <a href="/tags" class="site-nav">
            标签
          </a>
        
      
        
          <a href="/post/about" class="site-nav">
            关于
          </a>
        
      
    </div>
  </div>
  <div class="bottom-container" data-aos="flip-up" data-aos-offset="0">
    <div class="social-container">
      
        
      
        
      
        
      
        
      
        
      
    </div>
    <div class="site-description">
      仰天大笑出门去，我辈岂是蓬蒿人！
    </div>
    <div class="site-footer">
      Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | <a class="rss" href="https://lienguang0624.github.io//atom.xml" target="_blank">RSS</a>
    </div>
  </div>
</div>


      <div class="main-container">
        <div class="content-container" data-aos="fade-up">
          <div class="post-detail">
            <h2 class="post-title">量化交易——发明者平台常用API</h2>
            <div class="post-date">2021-04-22</div>
            
            <div class="post-content" v-pre>
              <h1 id="基本策略框架">基本策略框架</h1>
<pre><code class="language-python">def onTick():
    Log(exchange.GetTicker())

def main():
    while True:
        onTick()
        Sleep(60000)
</code></pre>
<p><code>onTick()</code>函数中定义操作内容<br>
<code>Sleep()</code>函数控制访问交易所API接口的频率</p>
<h1 id="行情api">行情API</h1>
<h2 id="exchangegetticker-获取市场当前行情">exchange.GetTicker() 获取市场当前行情</h2>
<pre><code class="language-c">{
    Info    : {...},             // 请求交易所接口后，交易所接口应答的原始数据，回测时无此属性
    High    : 1000,              // 最高价
    Low     : 500,               // 最低价
    Sell    : 900,               // 卖一价
    Buy     : 899,               // 买一价
    Last    : 900,               // 最后成交价
    Volume  : 10000000,          // 最近成交量
    Time    : 1567736576000      // 毫秒级别时间戳
}
</code></pre>
<p>python下调用方式：</p>
<pre><code class="language-python">def main():
    ticker = exchange.GetTicker()
    Log(&quot;High:&quot;, ticker[&quot;High&quot;], &quot;Low:&quot;, ticker[&quot;Low&quot;], &quot;Sell:&quot;, ticker[&quot;Sell&quot;], &quot;Buy:&quot;, ticker[&quot;Buy&quot;], &quot;Last:&quot;, ticker[&quot;Last&quot;], &quot;Volume:&quot;, ticker[&quot;Volume&quot;])
</code></pre>
<h2 id="exchangegetrecords-获取历史行情">exchange.GetRecords() 获取历史行情</h2>
<pre><code class="language-c">{
    Time    : 1567736576000,     // 一个时间戳,精确到毫秒，与Javascript的new Date().getTime()得到的结果格式一样
    Open    : 1000,              // 开盘价
    High    : 1500,              // 最高价
    Low     : 900,               // 最低价
    Close   : 1200,              // 收盘价
    Volume  : 1000000            // 交易量
}
</code></pre>
<p>python下调用方式：</p>
<pre><code class="language-python">def main():
    Log(exchange.GetRecords(60 * 2))
    Log(exchange.GetRecords(PERIOD_M5))
</code></pre>
<p>参数值:<code>PERIOD_M1</code>指1分钟,<code>PERIOD_M5</code>指5分钟,<code>PERIOD_M15</code>指15分钟,<code>PERIOD_M30</code>指30分钟,<code>PERIOD_H1</code>指1小时,<code>PERIOD_D1</code>指一天,Period参数设置5，即为请求5秒为周期的K线数据。<br>
Record结构体内容：</p>
<pre><code class="language-python">def main():
    records = exchange.GetRecords(PERIOD_H1)
    Log(&quot;第一根k线数据为，Time:&quot;, records[0][&quot;Time&quot;], &quot;Open:&quot;, records[0][&quot;Open&quot;], &quot;High:&quot;, records[0][&quot;High&quot;])
    Log(&quot;第二根k线数据为，Time:&quot;, records[1][&quot;Time&quot;], &quot;Close:&quot;, records[1][&quot;Close&quot;])
    Log(&quot;当前K线（最新）&quot;, records[-1], &quot;上一根K线&quot;, records[-2])
</code></pre>
<h2 id="exchangegetaccount-获取账户信息">exchange.GetAccount() 获取账户信息</h2>
<pre><code class="language-c">{
    Info            : {...},     // 请求交易所接口后，交易所接口应答的原始数据，回测时无此属性
    Balance         : 1000,      // 余额(人民币或者美元,在Poloniex交易所里ETC_BTC这样的品种,Balance就指的是BTC的数量,Stocks指的是ETC数量)
    FrozenBalance   : 0,         // 冻结的余额
    Stocks          : 1,         // BTC/LTC数量,数字货币现货为当前可操作币的余额(去掉冻结的币),数字货币期货的话为合约当前可用保证金(传统期货无此属性)
    FrozenStocks    : 0          // 冻结的BTC/LTC数量(传统期货无此属性)
}
</code></pre>
<p>Account结构体:</p>
<pre><code class="language-python">def main():
    account = exchange.GetAccount()
    Log(&quot;账户信息，Balance&quot;, account[&quot;Balance&quot;], &quot;FrozenBalance:&quot;, account[&quot;FrozenBalance&quot;], &quot;Stocks:&quot;, 
        account[&quot;Stocks&quot;], &quot;FrozenStocks:&quot;, account[&quot;FrozenStocks&quot;])
</code></pre>
<h2 id="exchangegetposition-获取仓位信息">exchange.GetPosition() 获取仓位信息</h2>
<pre><code class="language-c">{
    Info            : {...},     // 请求交易所接口后，交易所接口应答的原始数据，回测时无此属性
    MarginLevel     : 10,        // 杆杠大小
    Amount          : 100,       // 持仓量，OKEX合约交易所，表示合约的份数(整数且大于1，即合约张数)
    FrozenAmount    : 0,         // 仓位冻结量
    Price           : 10000,     // 持仓均价
    Profit          : 0,         // 持仓浮动盈亏(数据货币单位：BTC/LTC,传统期货单位:RMB,股票不支持此字段,注:OKEX合约全仓情况下指实现盈余,并非持仓盈亏,逐仓下指持仓盈亏)
    Type            : 0,         // PD_LONG为多头仓位(CTP中用closebuy_today平仓),PD_SHORT为空头仓位(CTP用closesell_today)平仓,(CTP期货中)PD_LONG_YD为咋日多头仓位(用closebuy平),PD_SHORT_YD为咋日空头仓位(用closesell平)
    ContractType    : &quot;quarter&quot;, // 商品期货为合约代码,股票为'交易所代码_股票代码',具体参数SetContractType的传入类型
    Margin          : 1          // 仓位占用的保证金
}
</code></pre>
<p>Position结构体:</p>
<pre><code class="language-python">def main():
    exchange.SetContractType(&quot;this_week&quot;)
    exchange.SetMarginLevel(10)
    exchange.SetDirection(&quot;buy&quot;)
    exchange.Buy(10000, 2)
    position = exchange.GetPosition()
    if len(position) &gt; 0:
        Log(&quot;Amount:&quot;, position[0][&quot;Amount&quot;], &quot;FrozenAmount:&quot;, position[0][&quot;FrozenAmount&quot;], &quot;Price:&quot;, 
            position[0][&quot;Price&quot;], &quot;Profit:&quot;, position[0][&quot;Profit&quot;], &quot;Type:&quot;, position[0][&quot;Type&quot;], 
            &quot;ContractType:&quot;, position[0][&quot;ContractType&quot;])
</code></pre>
<h2 id="_cfunction-args-重试函数">_C(function, args...) 重试函数</h2>
<pre><code class="language-c">exchange.GetTicker()
exchange.GetDepth()
exchange.GetTrades()
exchange.GetRecords()
exchange.GetAccount()
exchange.GetOrders()
exchange.GetOrder()
exchange.GetPosition()
</code></pre>
<p>以上函数都通过_C(...)来调用，以防出错</p>
<h1 id="日志api">日志API</h1>
<h2 id="log-日志信息">Log(...) 日志信息</h2>
<pre><code class="language-python">def main():
    Log(&quot;发明者量化你好 !@&quot;)
    Sleep(1000 * 5)
    Log(&quot;微信你好, #ff0000@&quot;)
</code></pre>
<h2 id="logprofitprofit-记录收益">LogProfit(Profit) 记录收益</h2>
<p>可以以字符&amp;结尾，实现只绘制收益图表，不打印收益日志：<code>LogProfit(10, '&amp;')</code></p>
<h1 id="交易apu">交易APU</h1>
<h2 id="exchangebuyprice-amount-买入">exchange.Buy(Price, Amount) 买入</h2>
<p>购买市价单</p>
<pre><code class="language-python">def main():
    exchange.Buy(-1, 0.1)
</code></pre>
<h2 id="exchangesellprice-amount-卖出">exchange.Sell(Price, Amount) 卖出</h2>
<p>卖出市价单</p>
<pre><code class="language-python">def main():
    id = exchange.Sell(-1, 1)
    Log(&quot;id:&quot;, id)
</code></pre>
<h1 id="期货交易">期货交易</h1>
<h2 id="exchangesetprecisionpriceprecision-amountprecision-设置买卖精度">exchange.SetPrecision(PricePrecision, AmountPrecision) 设置买卖精度</h2>
<p>设置价格与品种下单量的小数位精度,设置后会自动截断，参数值：PricePrecision为number类型，用来控制价格后面的小数点位，AmountPrecision为number类型，用来控制数量后面的小数点位</p>
<pre><code class="language-python">def main():
    exchange.SetPrecision(2, 3)
</code></pre>
<p>注意：回测不支持该函数，回测的数值精度会自动处理。</p>
<h2 id="exchangesetmarginlevelmarginlevel-设置杆杠大小-参数值number-类型">exchange.SetMarginLevel(MarginLevel) 设置杆杠大小。参数值：number 类型</h2>
<pre><code class="language-python">def main():
    exchange.SetMarginLevel(10)
</code></pre>
<h2 id="exchangesetdirectiondirection-设置buy或者sell下单类型-参数值string类型">exchange.SetDirection(Direction) 设置Buy或者Sell下单类型。参数值：string类型</h2>
<pre><code class="language-python">def main():
    // 举例设置为OKEX期货当周合约
    exchange.SetContractType(&quot;this_week&quot;)    
    // 设置杠杆为5倍
    exchange.SetMarginLevel(5)
    // 设置下单类型为做多
    exchange.SetDirection(&quot;buy&quot;)
    // 以10000的价格，合约数量为2张下单
    exchange.Buy(10000, 2)              
    exchange.SetMarginLevel(5)
    exchange.SetDirection(&quot;closebuy&quot;)
    exchange.Sell(1000, 2)
</code></pre>
<h1 id="exchangesetcontracttypecontracttype设置合约类型">exchange.SetContractType(ContractType)，设置合约类型</h1>
<pre><code class="language-python">def main():
    exchange.SetContractType(&quot;this_week&quot;)
</code></pre>
<p>有<code>this_week</code>,<code>next_week</code>,<code>quarter</code>三个参数，永续合约为：<code>swap</code>。</p>

            </div>
            
            
              <div class="next-post">
                <div class="next">下一篇</div>
                <a href="https://lienguang0624.github.io/post/markdown/">
                  <h3 class="post-title">
                    Markdown用法简介
                  </h3>
                </a>
              </div>
            

            

          </div>

        </div>
      </div>
    </div>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
<script type="application/javascript">

AOS.init();

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>






  </body>
</html>
